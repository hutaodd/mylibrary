---
created: 2025-03-05T21:38
updated: 2025-03-05T21:38
---
### 算术运算
1. **`abs(x)`**
    - **含义**：返回`x`的绝对值。
2. **`add(x, y, filter = false), x + y`**
    - **含义**：将所有输入值（至少需要2个输入）相加。如果`filter = true`，在相加前将所有输入的`NaN`值过滤为0。
3. **`densify(x)`**
    - **含义**：将具有多个桶的分组字段转换为数量更少的仅包含可用桶的形式，以便在计算上更高效地处理分组字段。
4. **`divide(x, y), x / y`**
    - **含义**：返回`x`除以`y`的结果。
5. **`inverse(x)`**
    - **含义**：返回`1 / x`。
6. **`log(x)`**
    - **含义**：返回`x`的自然对数。例如：`Log(high/low)`使用`high/low`比率的自然对数作为股票权重。
7. **`max(x, y, ..)`**
    - **含义**：返回所有输入值中的最大值。至少需要2个输入。
8. **`min(x, y ..)`**
    - **含义**：返回所有输入值中的最小值。至少需要2个输入。
9. **`multiply(x, y, ... , filter=false), x * y`**
    - **含义**：将所有输入值相乘（至少需要2个输入）。`filter`参数将`NaN`值设置为1。
10. **`power(x, y)`**
    - **含义**：返回`x`的`y`次幂，即`x ^ y`。
11. **`reverse(x)`**
    - **含义**：返回`-x`。
12. **`sign(x)`**
    - **含义**：如果输入为`NaN`，则返回`NaN`。
13. **`signed_power(x, y)`**
    - **含义**：返回`x`的`y`次幂，且最终结果保留`x`的符号。
14. **`subtract(x, y, filter=false), x - y`**
    - **含义**：返回`x - y`的结果。如果`filter = true`，在相减前将所有输入的`NaN`值过滤为0。

### 逻辑运算
1. **`and(input1, input2)`**
    - **含义**：逻辑与运算符，如果两个操作数都为真，则返回`true`，否则返回`false`。
2. **`if_else(input1, input2, input 3)`**
    - **含义**：如果`input1`为真，则返回`input2`，否则返回`input3`。
3. **`input1 < input2`**
    - **含义**：如果`input1`小于`input2`，则返回`true`，否则返回`false`。
4. **`input1 <= input2`**
    - **含义**：如果`input1`小于或等于`input2`，则返回`true`，否则返回`false`。
5. **`input1 == input2`**
    - **含义**：如果两个输入值相同，则返回`true`，否则返回`false`。
6. **`input1 > input2`**
    - **含义**：逻辑比较运算符，用于比较两个输入值。
7. **`input1 >= input2`**
    - **含义**：如果`input1`大于或等于`input2`，则返回`true`，否则返回`false`。
8. **`input1!= input2`**
    - **含义**：如果两个输入值不相同，则返回`true`，否则返回`false`。
9. **`is_nan(input)`**
    - **含义**：如果`input`等于`NaN`，则返回1，否则返回0。
10. **`not(x)`**
    - **含义**：返回`x`的逻辑取反。如果`x`为真（1），则返回假（0）；如果`x`为假（0），则返回真（1）。
11. **`or(input1, input2)`**
    - **含义**：逻辑或运算符，如果两个输入值中的任意一个或两个都为真，则返回`true`，否则返回`false`。

### 时间序列运算
1. **`days_from_last_change(x)`**
    - **含义**：返回自`x`上次变化以来的天数。
2. **`hump(x, hump = 0.01)`**
    - **含义**：限制输入值的变化量和变化幅度（从而减少换手率）。
3. **`kth_element(x, d, k)`**
    - **含义**：通过查看过去`d`天，返回输入的第`k`个值。如果`k = 1`，此运算符可用于回填缺失数据。
4. **`last_diff_value(x, d)`**
    - **含义**：返回过去`d`天中最后一个与当前`x`值不相等的`x`值。
5. **`ts_arg_max(x, d)`**
    - **含义**：返回过去`d`天时间序列中最大值的相对索引。如果当前天是过去`d`天中的最大值，则返回0；如果前一天是过去`d`天中的最大值，则返回1。
6. **`ts_arg_min(x, d)`**
    - **含义**：返回过去`d`天时间序列中最小值的相对索引。如果当前天是过去`d`天中的最小值，则返回0；如果前一天是过去`d`天中的最小值，则返回1。
7. **`ts_av_diff(x, d)`**
    - **含义**：返回`x - tsmean(x, d)`，但会仔细处理`NaN`值，即在计算均值时忽略`NaN`值。
8. **`ts_backfill(x,lookback = d, k=1, ignore="NAN")`**
    - **含义**：回填是将`NaN`或0值替换为有意义的值（即第一个非`NaN`值）的过程。
9. **`ts_corr(x, y, d)`**
    - **含义**：返回过去`d`天`x`和`y`的相关性。
10. **`ts_count_nans(x, d)`**
    - **含义**：返回过去`d`天中`x`的`NaN`值的数量。
11. **`ts_covariance(y, x, d)`**
    - **含义**：返回过去`d`天`y`和`x`的协方差。
12. **`ts_decay_linear(x, d, dense = false)`**
    - **含义**：返回过去`d`天`x`的线性衰减。`dense`参数为`false`表示运算符在稀疏模式下工作，将`NaN`视为0；在密集模式下则不这样处理。
13. **`ts_delay(x, d)`**
    - **含义**：返回`d`天前的`x`值。
14. **`ts_delta(x, d)`**
    - **含义**：返回`x - ts_delay(x, d)`。
15. **`ts_mean(x, d)`**
    - **含义**：返回过去`d`天`x`的平均值。
16. **`ts_product(x, d)`**
    - **含义**：返回过去`d`天`x`的乘积。
17. **`ts_quantile(x,d, driver="gaussian")`**
    - **含义**：它计算`ts_rank`，并将驱动分布的逆累积密度函数应用于其值。`driver`（可选）的可能值为“gaussian”（高斯分布）、“uniform”（均匀分布）、“cauchy”（柯西分布），默认值为“gaussian”。
18. **`ts_rank(x, d, constant = 0)`**
    - **含义**：对过去`d`天中每个工具的`x`值进行排名，然后返回当前值的排名加上`constant`。如果未指定，默认`constant = 0`。
19. **`ts_regression(y, x, d, lag = 0, rettype = 0)`**
    - **含义**：返回与回归函数相关的各种参数。
20. **`ts_scale(x, d, constant = 0)`**
    - **含义**：返回`(x - ts_min(x, d)) / (ts_max(x, d) - ts_min(x, d)) + constant`。此运算符类似于缩小运算符，但在时间序列空间中起作用。
21. **`ts_std_dev(x, d)`**
    - **含义**：返回过去`d`天`x`的标准差。
22. **`ts_step(1)`**
    - **含义**：返回天数计数器。
23. **`ts_sum(x, d)`**
    - **含义**：返回过去`d`天`x`值的总和。
24. **`ts_zscore(x, d)`**
    - **含义**：Z分数是一种数值度量，用于描述一个值与一组值的均值之间的关系。Z分数以标准差为单位从均值开始测量：`(x - tsmean(x,d)) / tsstddev(x,d)`。此运算符可能有助于减少异常值和回撤。

### 横截面运算
1. **`normalize(x, useStd = false, limit = 0.0)`**
    - **含义**：计算某一日期所有有效alpha值的平均值，然后从每个元素中减去该平均值。
2. **`quantile(x, driver = gaussian, sigma = 1.0)`**
    - **含义**：对原始向量进行排名，移动排名后的Alpha向量，应用分布（高斯分布、柯西分布、均匀分布）。如果`driver`是均匀分布，则简单地从Alpha向量中的每个Alpha值中减去所有Alpha值的平均值。
3. **`rank(x, rate=2)`**
    - **含义**：对所有工具中的输入进行排名，并返回一个在0.0到1.0之间均匀分布的数字。为了精确排序，可将`rate`设为0。
4. **`scale(x, scale=1, longscale=1, shortscale=1)`**
    - **含义**：将输入缩放至仓位大小。我们还可以通过为运算符指定其他参数，将多头头寸和空头头寸分别缩放到不同的比例。
5. **`winsorize(x, std=4)`**
    - **含义**：对`x`进行缩尾处理，以确保`x`中的所有值都在由`std`的倍数指定的上下限之间。详细信息可在维基百科上找到。
6. **`zscore(x)`**
    - **含义**：Z分数是一种数值度量，用于描述一个值与一组值的均值之间的关系。Z分数以标准差为单位从均值开始测量。

### 向量运算
1. **`vec_avg(x)`**
    - **含义**：计算向量字段`x`的平均值。
2. **`vec_sum(x)`**
    - **含义**：计算向量字段`x`的总和。

### 转换运算
1. **`bucket(rank(x), range="0, 1, 0.1" or buckets = "2,5,6,7,10")`**
    - **含义**：将浮点值转换为用户指定桶的索引。桶对于创建分组值很有用，可将分组值作为输入传递给`GROUP`。
2. **`trade_when(x, y, z)`**
    - **含义**：用于仅在指定条件下更改Alpha值，在其他情况下保持Alpha值。它还允许在指定条件下关闭Alpha头寸（分配`NaN`值）。

### 分组运算
1. **`group_backfill(x, group, d, std = 4.0)`**
    - **含义**：如果某一日期和工具的特定值为`NaN`，则从同一组工具中，计算过去`d`天所有非`NaN`值的缩尾均值。
2. **`group_mean(x, weight, group)`**
    - **含义**：组中的所有元素都等于该组的均值。
3. **`group_neutralize(x, group)`**
    - **含义**：针对组（这些组可以是子行业、行业、部门、国家或常数）对Alpha进行中性化处理。
4. **`group_rank(x, group)`**
    - **含义**：为组中的每个元素分配该组内相应的排名。
5. **`group_zscore(x, group)`**
    - **含义**：计算组Z分数，即一种数值度量，用于描述一个值与组内一组值的均值之间的关系。Z分数以标准差为单位从均值开始测量。`zscore = (data - mean) / stddev`，其中`data`、`mean`和`stddev`是针对组内每个工具的`x`值计算的。 