/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => GitSyncPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var child_process = __toESM(require("child_process"));
var DEFAULT_SETTINGS = {
  gitRepoPath: "",
  syncButtonLocation: "ribbon",
  autoSync: false,
  autoSyncInterval: 30,
  syncOnBlur: false
};
var GitSyncPlugin = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new GitSyncSettingTab(this.app, this));
    this.addSyncButton();
    this.addCommand({
      id: "git-sync",
      name: "\u6267\u884CGit\u540C\u6B65",
      callback: () => this.syncGit()
    });
    this.setupAutoSync();
    if (this.settings.syncOnBlur) {
      window.addEventListener("blur", this.onBlur.bind(this));
    }
  }
  onunload() {
    if (this.autoSyncIntervalId) {
      window.clearInterval(this.autoSyncIntervalId);
    }
    window.removeEventListener("blur", this.onBlur.bind(this));
  }
  setupAutoSync() {
    if (this.autoSyncIntervalId) {
      window.clearInterval(this.autoSyncIntervalId);
    }
    if (this.settings.autoSync) {
      this.autoSyncIntervalId = window.setInterval(() => {
        this.syncGit(true);
      }, this.settings.autoSyncInterval * 60 * 1e3);
    }
  }
  onBlur() {
    if (this.settings.syncOnBlur) {
      this.syncGit(true);
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.setupAutoSync();
  }
  addSyncButton() {
    if (this.settings.syncButtonLocation === "ribbon") {
      this.ribbonIconEl = this.addRibbonIcon("sync", "Git\u540C\u6B65", (evt) => {
        this.syncGit();
      });
    } else {
      this.statusBarItem = this.addStatusBarItem();
      this.statusBarItem.setText("Git\u540C\u6B65");
      this.statusBarItem.onClickEvent(() => this.syncGit());
    }
  }
  async syncGit(silent = false) {
    if (!this.settings.gitRepoPath) {
      if (!silent)
        new import_obsidian.Notice("\u8BF7\u5148\u5728\u8BBE\u7F6E\u4E2D\u914D\u7F6EGit\u4ED3\u5E93\u8DEF\u5F84");
      return;
    }
    if (!silent)
      new import_obsidian.Notice("\u5F00\u59CB\u68C0\u67E5\u66F4\u65B0...");
    try {
      const status = await this.execGitCommand("git status --porcelain");
      const hasLocalChanges = status.trim().length > 0;
      await this.execGitCommand("git fetch");
      const diffResult = await this.execGitCommand("git diff HEAD origin/master --name-only");
      const hasRemoteChanges = diffResult.trim().length > 0;
      if (!hasLocalChanges && !hasRemoteChanges) {
        if (!silent)
          new import_obsidian.Notice("\u65E0\u9700\u540C\u6B65\uFF0C\u672C\u5730\u4E0E\u8FDC\u7A0B\u5747\u65E0\u66F4\u65B0");
        return;
      }
      if (!silent)
        new import_obsidian.Notice("\u5F00\u59CB\u540C\u6B65...");
      if (hasLocalChanges) {
        await this.execGitCommand("git add .");
        await this.execGitCommand('git commit -m "Auto sync: ' + new Date().toISOString() + '"');
      }
      if (hasRemoteChanges) {
        await this.execGitCommand("git pull");
      }
      if (hasLocalChanges) {
        await this.execGitCommand("git push");
      }
      if (!silent) {
        if (!hasLocalChanges && hasRemoteChanges) {
          new import_obsidian.Notice("\u672C\u5730\u65E0\u66F4\u65B0\uFF0C\u5DF2\u4ECE\u8FDC\u7A0B\u62C9\u53D6\u66F4\u65B0");
        } else if (hasLocalChanges) {
          new import_obsidian.Notice("\u672C\u5730\u66F4\u65B0\u5DF2\u540C\u6B65\u81F3\u8FDC\u7A0B");
        }
      }
    } catch (error) {
      if (!silent)
        new import_obsidian.Notice("\u540C\u6B65\u5931\u8D25: " + error);
    }
  }
  async execGitCommand(command) {
    return new Promise((resolve, reject) => {
      child_process.exec(command, { cwd: this.settings.gitRepoPath }, (error, stdout, stderr) => {
        if (error) {
          reject(error);
        } else {
          resolve(stdout);
        }
      });
    });
  }
};
var GitSyncSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Git\u4ED3\u5E93\u8DEF\u5F84").setDesc("\u8BBE\u7F6EGit\u4ED3\u5E93\u7684\u672C\u5730\u8DEF\u5F84").addText((text) => text.setPlaceholder("\u8F93\u5165Git\u4ED3\u5E93\u8DEF\u5F84").setValue(this.plugin.settings.gitRepoPath).onChange(async (value) => {
      this.plugin.settings.gitRepoPath = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("\u540C\u6B65\u6309\u94AE\u4F4D\u7F6E").setDesc("\u9009\u62E9\u540C\u6B65\u6309\u94AE\u663E\u793A\u7684\u4F4D\u7F6E").addDropdown((dropdown) => dropdown.addOption("ribbon", "\u5DE6\u4FA7\u529F\u80FD\u533A").addOption("statusBar", "\u72B6\u6001\u680F").setValue(this.plugin.settings.syncButtonLocation).onChange(async (value) => {
      var _a, _b;
      this.plugin.settings.syncButtonLocation = value;
      await this.plugin.saveSettings();
      (_a = this.plugin.ribbonIconEl) == null ? void 0 : _a.remove();
      (_b = this.plugin.statusBarItem) == null ? void 0 : _b.remove();
      this.plugin.addSyncButton();
    }));
    new import_obsidian.Setting(containerEl).setName("\u542F\u7528\u81EA\u52A8\u540C\u6B65").setDesc("\u5B9A\u671F\u81EA\u52A8\u6267\u884C\u540C\u6B65").addToggle((toggle) => toggle.setValue(this.plugin.settings.autoSync).onChange(async (value) => {
      this.plugin.settings.autoSync = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("\u81EA\u52A8\u540C\u6B65\u95F4\u9694").setDesc("\u8BBE\u7F6E\u81EA\u52A8\u540C\u6B65\u7684\u65F6\u95F4\u95F4\u9694\uFF08\u5206\u949F\uFF09").addText((text) => text.setPlaceholder("\u8F93\u5165\u5206\u949F\u6570").setValue(String(this.plugin.settings.autoSyncInterval)).onChange(async (value) => {
      const interval = parseInt(value);
      if (!isNaN(interval) && interval > 0) {
        this.plugin.settings.autoSyncInterval = interval;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian.Setting(containerEl).setName("\u5931\u53BB\u7126\u70B9\u65F6\u540C\u6B65").setDesc("\u5F53Obsidian\u7A97\u53E3\u5931\u53BB\u7126\u70B9\u65F6\u6267\u884C\u540C\u6B65").addToggle((toggle) => toggle.setValue(this.plugin.settings.syncOnBlur).onChange(async (value) => {
      this.plugin.settings.syncOnBlur = value;
      await this.plugin.saveSettings();
      if (value) {
        window.addEventListener("blur", this.plugin.onBlur.bind(this.plugin));
      } else {
        window.removeEventListener("blur", this.plugin.onBlur.bind(this.plugin));
      }
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBCdXR0b25Db21wb25lbnQgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCAqIGFzIGNoaWxkX3Byb2Nlc3MgZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XHJcblxyXG4vLyBSZW1lbWJlciB0byByZW5hbWUgdGhlc2UgY2xhc3NlcyBhbmQgaW50ZXJmYWNlcyFcclxuXHJcbmludGVyZmFjZSBHaXRTeW5jUGx1Z2luU2V0dGluZ3Mge1xyXG5cdGdpdFJlcG9QYXRoOiBzdHJpbmc7XHJcblx0c3luY0J1dHRvbkxvY2F0aW9uOiAncmliYm9uJyB8ICdzdGF0dXNCYXInO1xyXG5cdGF1dG9TeW5jOiBib29sZWFuO1xyXG5cdGF1dG9TeW5jSW50ZXJ2YWw6IG51bWJlcjsgLy8gXHU0RUU1XHU1MjA2XHU5NDlGXHU0RTNBXHU1MzU1XHU0RjREXHJcblx0c3luY09uQmx1cjogYm9vbGVhbjtcclxufVxyXG5cclxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogR2l0U3luY1BsdWdpblNldHRpbmdzID0ge1xyXG5cdGdpdFJlcG9QYXRoOiAnJyxcclxuXHRzeW5jQnV0dG9uTG9jYXRpb246ICdyaWJib24nLFxyXG5cdGF1dG9TeW5jOiBmYWxzZSxcclxuXHRhdXRvU3luY0ludGVydmFsOiAzMCxcclxuXHRzeW5jT25CbHVyOiBmYWxzZVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHaXRTeW5jUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogR2l0U3luY1BsdWdpblNldHRpbmdzO1xyXG5cdHN0YXR1c0Jhckl0ZW06IEhUTUxFbGVtZW50O1xyXG5cdHJpYmJvbkljb25FbDogSFRNTEVsZW1lbnQ7XHJcblx0YXV0b1N5bmNJbnRlcnZhbElkOiBudW1iZXI7XHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblxyXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBHaXRTeW5jU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xyXG5cclxuXHRcdHRoaXMuYWRkU3luY0J1dHRvbigpO1xyXG5cclxuXHRcdC8vIFx1NkRGQlx1NTJBMFx1NTQ3RFx1NEVFNFxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6ICdnaXQtc3luYycsXHJcblx0XHRcdG5hbWU6ICdcdTYyNjdcdTg4NENHaXRcdTU0MENcdTZCNjUnLFxyXG5cdFx0XHRjYWxsYmFjazogKCkgPT4gdGhpcy5zeW5jR2l0KCksXHJcblx0XHR9KTtcclxuXHJcblx0XHR0aGlzLnNldHVwQXV0b1N5bmMoKTtcclxuXHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5zeW5jT25CbHVyKSB7XHJcblx0XHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5vbkJsdXIuYmluZCh0aGlzKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRvbnVubG9hZCgpIHtcclxuXHRcdGlmICh0aGlzLmF1dG9TeW5jSW50ZXJ2YWxJZCkge1xyXG5cdFx0XHR3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmF1dG9TeW5jSW50ZXJ2YWxJZCk7XHJcblx0XHR9XHJcblx0XHR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMub25CbHVyLmJpbmQodGhpcykpO1xyXG5cdH1cclxuXHJcblx0c2V0dXBBdXRvU3luYygpIHtcclxuXHRcdGlmICh0aGlzLmF1dG9TeW5jSW50ZXJ2YWxJZCkge1xyXG5cdFx0XHR3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmF1dG9TeW5jSW50ZXJ2YWxJZCk7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5hdXRvU3luYykge1xyXG5cdFx0XHR0aGlzLmF1dG9TeW5jSW50ZXJ2YWxJZCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5zeW5jR2l0KHRydWUpO1xyXG5cdFx0XHR9LCB0aGlzLnNldHRpbmdzLmF1dG9TeW5jSW50ZXJ2YWwgKiA2MCAqIDEwMDApO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0b25CbHVyKCkge1xyXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3Muc3luY09uQmx1cikge1xyXG5cdFx0XHR0aGlzLnN5bmNHaXQodHJ1ZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcblx0XHR0aGlzLnNldHVwQXV0b1N5bmMoKTtcclxuXHR9XHJcblxyXG5cdGFkZFN5bmNCdXR0b24oKSB7XHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5zeW5jQnV0dG9uTG9jYXRpb24gPT09ICdyaWJib24nKSB7XHJcblx0XHRcdHRoaXMucmliYm9uSWNvbkVsID0gdGhpcy5hZGRSaWJib25JY29uKCdzeW5jJywgJ0dpdFx1NTQwQ1x1NkI2NScsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuXHRcdFx0XHR0aGlzLnN5bmNHaXQoKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLnN0YXR1c0Jhckl0ZW0gPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcclxuXHRcdFx0dGhpcy5zdGF0dXNCYXJJdGVtLnNldFRleHQoJ0dpdFx1NTQwQ1x1NkI2NScpO1xyXG5cdFx0XHR0aGlzLnN0YXR1c0Jhckl0ZW0ub25DbGlja0V2ZW50KCgpID0+IHRoaXMuc3luY0dpdCgpKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIHN5bmNHaXQoc2lsZW50OiBib29sZWFuID0gZmFsc2UpIHtcclxuXHRcdGlmICghdGhpcy5zZXR0aW5ncy5naXRSZXBvUGF0aCkge1xyXG5cdFx0XHRpZiAoIXNpbGVudCkgbmV3IE5vdGljZSgnXHU4QkY3XHU1MTQ4XHU1NzI4XHU4QkJFXHU3RjZFXHU0RTJEXHU5MTREXHU3RjZFR2l0XHU0RUQzXHU1RTkzXHU4REVGXHU1Rjg0Jyk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIXNpbGVudCkgbmV3IE5vdGljZSgnXHU1RjAwXHU1OUNCXHU2OEMwXHU2N0U1XHU2NkY0XHU2NUIwLi4uJyk7XHJcblxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3Qgc3RhdHVzID0gYXdhaXQgdGhpcy5leGVjR2l0Q29tbWFuZCgnZ2l0IHN0YXR1cyAtLXBvcmNlbGFpbicpO1xyXG5cdFx0XHRjb25zdCBoYXNMb2NhbENoYW5nZXMgPSBzdGF0dXMudHJpbSgpLmxlbmd0aCA+IDA7XHJcblxyXG5cdFx0XHRhd2FpdCB0aGlzLmV4ZWNHaXRDb21tYW5kKCdnaXQgZmV0Y2gnKTtcclxuXHRcdFx0Y29uc3QgZGlmZlJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY0dpdENvbW1hbmQoJ2dpdCBkaWZmIEhFQUQgb3JpZ2luL21hc3RlciAtLW5hbWUtb25seScpO1xyXG5cdFx0XHRjb25zdCBoYXNSZW1vdGVDaGFuZ2VzID0gZGlmZlJlc3VsdC50cmltKCkubGVuZ3RoID4gMDtcclxuXHJcblx0XHRcdGlmICghaGFzTG9jYWxDaGFuZ2VzICYmICFoYXNSZW1vdGVDaGFuZ2VzKSB7XHJcblx0XHRcdFx0aWYgKCFzaWxlbnQpIG5ldyBOb3RpY2UoJ1x1NjVFMFx1OTcwMFx1NTQwQ1x1NkI2NVx1RkYwQ1x1NjcyQ1x1NTczMFx1NEUwRVx1OEZEQ1x1N0EwQlx1NTc0N1x1NjVFMFx1NjZGNFx1NjVCMCcpO1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCFzaWxlbnQpIG5ldyBOb3RpY2UoJ1x1NUYwMFx1NTlDQlx1NTQwQ1x1NkI2NS4uLicpO1xyXG5cclxuXHRcdFx0aWYgKGhhc0xvY2FsQ2hhbmdlcykge1xyXG5cdFx0XHRcdGF3YWl0IHRoaXMuZXhlY0dpdENvbW1hbmQoJ2dpdCBhZGQgLicpO1xyXG5cdFx0XHRcdGF3YWl0IHRoaXMuZXhlY0dpdENvbW1hbmQoJ2dpdCBjb21taXQgLW0gXCJBdXRvIHN5bmM6ICcgKyBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgKyAnXCInKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKGhhc1JlbW90ZUNoYW5nZXMpIHtcclxuXHRcdFx0XHRhd2FpdCB0aGlzLmV4ZWNHaXRDb21tYW5kKCdnaXQgcHVsbCcpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoaGFzTG9jYWxDaGFuZ2VzKSB7XHJcblx0XHRcdFx0YXdhaXQgdGhpcy5leGVjR2l0Q29tbWFuZCgnZ2l0IHB1c2gnKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCFzaWxlbnQpIHtcclxuXHRcdFx0XHRpZiAoIWhhc0xvY2FsQ2hhbmdlcyAmJiBoYXNSZW1vdGVDaGFuZ2VzKSB7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKCdcdTY3MkNcdTU3MzBcdTY1RTBcdTY2RjRcdTY1QjBcdUZGMENcdTVERjJcdTRFQ0VcdThGRENcdTdBMEJcdTYyQzlcdTUzRDZcdTY2RjRcdTY1QjAnKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKGhhc0xvY2FsQ2hhbmdlcykge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnXHU2NzJDXHU1NzMwXHU2NkY0XHU2NUIwXHU1REYyXHU1NDBDXHU2QjY1XHU4MUYzXHU4RkRDXHU3QTBCJyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRpZiAoIXNpbGVudCkgbmV3IE5vdGljZSgnXHU1NDBDXHU2QjY1XHU1OTMxXHU4RDI1OiAnICsgZXJyb3IpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YXN5bmMgZXhlY0dpdENvbW1hbmQoY29tbWFuZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblx0XHRcdGNoaWxkX3Byb2Nlc3MuZXhlYyhjb21tYW5kLCB7IGN3ZDogdGhpcy5zZXR0aW5ncy5naXRSZXBvUGF0aCB9LCAoZXJyb3IsIHN0ZG91dCwgc3RkZXJyKSA9PiB7XHJcblx0XHRcdFx0aWYgKGVycm9yKSB7XHJcblx0XHRcdFx0XHRyZWplY3QoZXJyb3IpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRyZXNvbHZlKHN0ZG91dCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgR2l0U3luY1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuXHRwbHVnaW46IEdpdFN5bmNQbHVnaW47XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEdpdFN5bmNQbHVnaW4pIHtcclxuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdH1cclxuXHJcblx0ZGlzcGxheSgpOiB2b2lkIHtcclxuXHRcdGNvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzO1xyXG5cclxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdHaXRcdTRFRDNcdTVFOTNcdThERUZcdTVGODQnKVxyXG5cdFx0XHQuc2V0RGVzYygnXHU4QkJFXHU3RjZFR2l0XHU0RUQzXHU1RTkzXHU3Njg0XHU2NzJDXHU1NzMwXHU4REVGXHU1Rjg0JylcclxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdcdThGOTNcdTUxNjVHaXRcdTRFRDNcdTVFOTNcdThERUZcdTVGODQnKVxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5naXRSZXBvUGF0aClcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5naXRSZXBvUGF0aCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0fSkpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnXHU1NDBDXHU2QjY1XHU2MzA5XHU5NEFFXHU0RjREXHU3RjZFJylcclxuXHRcdFx0LnNldERlc2MoJ1x1OTAwOVx1NjJFOVx1NTQwQ1x1NkI2NVx1NjMwOVx1OTRBRVx1NjYzRVx1NzkzQVx1NzY4NFx1NEY0RFx1N0Y2RScpXHJcblx0XHRcdC5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxyXG5cdFx0XHRcdC5hZGRPcHRpb24oJ3JpYmJvbicsICdcdTVERTZcdTRGQTdcdTUyOUZcdTgwRkRcdTUzM0EnKVxyXG5cdFx0XHRcdC5hZGRPcHRpb24oJ3N0YXR1c0JhcicsICdcdTcyQjZcdTYwMDFcdTY4MEYnKVxyXG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jQnV0dG9uTG9jYXRpb24pXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogJ3JpYmJvbicgfCAnc3RhdHVzQmFyJykgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3Muc3luY0J1dHRvbkxvY2F0aW9uID0gdmFsdWU7XHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnJpYmJvbkljb25FbD8ucmVtb3ZlKCk7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zdGF0dXNCYXJJdGVtPy5yZW1vdmUoKTtcclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLmFkZFN5bmNCdXR0b24oKTtcclxuXHRcdFx0XHR9KSk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdcdTU0MkZcdTc1MjhcdTgxRUFcdTUyQThcdTU0MENcdTZCNjUnKVxyXG5cdFx0XHQuc2V0RGVzYygnXHU1QjlBXHU2NzFGXHU4MUVBXHU1MkE4XHU2MjY3XHU4ODRDXHU1NDBDXHU2QjY1JylcclxuXHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9TeW5jKVxyXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9TeW5jID0gdmFsdWU7XHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHR9KSk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdcdTgxRUFcdTUyQThcdTU0MENcdTZCNjVcdTk1RjRcdTk2OTQnKVxyXG5cdFx0XHQuc2V0RGVzYygnXHU4QkJFXHU3RjZFXHU4MUVBXHU1MkE4XHU1NDBDXHU2QjY1XHU3Njg0XHU2NUY2XHU5NUY0XHU5NUY0XHU5Njk0XHVGRjA4XHU1MjA2XHU5NDlGXHVGRjA5JylcclxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdcdThGOTNcdTUxNjVcdTUyMDZcdTk0OUZcdTY1NzAnKVxyXG5cdFx0XHRcdC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b1N5bmNJbnRlcnZhbCkpXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0Y29uc3QgaW50ZXJ2YWwgPSBwYXJzZUludCh2YWx1ZSk7XHJcblx0XHRcdFx0XHRpZiAoIWlzTmFOKGludGVydmFsKSAmJiBpbnRlcnZhbCA+IDApIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b1N5bmNJbnRlcnZhbCA9IGludGVydmFsO1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KSk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdcdTU5MzFcdTUzQkJcdTcxMjZcdTcwQjlcdTY1RjZcdTU0MENcdTZCNjUnKVxyXG5cdFx0XHQuc2V0RGVzYygnXHU1RjUzT2JzaWRpYW5cdTdBOTdcdTUzRTNcdTU5MzFcdTUzQkJcdTcxMjZcdTcwQjlcdTY1RjZcdTYyNjdcdTg4NENcdTU0MENcdTZCNjUnKVxyXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcclxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3luY09uQmx1cilcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jT25CbHVyID0gdmFsdWU7XHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdGlmICh2YWx1ZSkge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMucGx1Z2luLm9uQmx1ci5iaW5kKHRoaXMucGx1Z2luKSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMucGx1Z2luLm9uQmx1ci5iaW5kKHRoaXMucGx1Z2luKSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSkpO1xyXG5cdH1cclxufVxyXG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUE2RztBQUM3RyxvQkFBK0I7QUFZL0IsSUFBTSxtQkFBMEM7QUFBQSxFQUMvQyxhQUFhO0FBQUEsRUFDYixvQkFBb0I7QUFBQSxFQUNwQixVQUFVO0FBQUEsRUFDVixrQkFBa0I7QUFBQSxFQUNsQixZQUFZO0FBQ2I7QUFFQSxJQUFxQixnQkFBckIsY0FBMkMsdUJBQU87QUFBQSxFQU1qRCxNQUFNLFNBQVM7QUFDZCxVQUFNLEtBQUssYUFBYTtBQUV4QixTQUFLLGNBQWMsSUFBSSxrQkFBa0IsS0FBSyxLQUFLLElBQUksQ0FBQztBQUV4RCxTQUFLLGNBQWM7QUFHbkIsU0FBSyxXQUFXO0FBQUEsTUFDZixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU0sS0FBSyxRQUFRO0FBQUEsSUFDOUIsQ0FBQztBQUVELFNBQUssY0FBYztBQUVuQixRQUFJLEtBQUssU0FBUyxZQUFZO0FBQzdCLGFBQU8saUJBQWlCLFFBQVEsS0FBSyxPQUFPLEtBQUssSUFBSSxDQUFDO0FBQUEsSUFDdkQ7QUFBQSxFQUNEO0FBQUEsRUFFQSxXQUFXO0FBQ1YsUUFBSSxLQUFLLG9CQUFvQjtBQUM1QixhQUFPLGNBQWMsS0FBSyxrQkFBa0I7QUFBQSxJQUM3QztBQUNBLFdBQU8sb0JBQW9CLFFBQVEsS0FBSyxPQUFPLEtBQUssSUFBSSxDQUFDO0FBQUEsRUFDMUQ7QUFBQSxFQUVBLGdCQUFnQjtBQUNmLFFBQUksS0FBSyxvQkFBb0I7QUFDNUIsYUFBTyxjQUFjLEtBQUssa0JBQWtCO0FBQUEsSUFDN0M7QUFDQSxRQUFJLEtBQUssU0FBUyxVQUFVO0FBQzNCLFdBQUsscUJBQXFCLE9B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
